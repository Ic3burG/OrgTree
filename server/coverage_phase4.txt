
> orgtree-server@1.0.0 test:coverage
> vitest run --coverage src/routes/saved-searches.test.ts src/routes/organizations.test.ts


[1m[46m RUN [49m[22m [36mv4.0.17 [39m[90m/Users/ojdavis/Claude Code/OrgTree/server[39m
      [2mCoverage enabled with [22m[33mv8[39m

[90mstdout[2m | src/routes/saved-searches.test.ts
[22m[39m[dotenv@17.2.3] injecting env (3) from .env.test -- tip: üóÇÔ∏è backup and recover secrets: https://dotenvx.com/ops

[90mstdout[2m | src/routes/organizations.test.ts
[22m[39m[dotenv@17.2.3] injecting env (3) from .env.test -- tip: ‚öôÔ∏è  load multiple .env files with { path: ['.env.local', '.env'] }

[90mstdout[2m | src/routes/saved-searches.test.ts
[22m[39mInitializing database at: /Users/ojdavis/Claude Code/OrgTree/server/database.db

 [32m‚úì[39m src/routes/saved-searches.test.ts [2m([22m[2m5 tests[22m[2m)[22m[32m 32[2mms[22m[39m
 [32m‚úì[39m src/routes/organizations.test.ts [2m([22m[2m14 tests[22m[2m)[22m[32m 62[2mms[22m[39m

[2m Test Files [22m [1m[32m2 passed[39m[22m[90m (2)[39m
[2m      Tests [22m [1m[32m19 passed[39m[22m[90m (19)[39m
[2m   Start at [22m 13:26:09
[2m   Duration [22m 608ms[2m (transform 214ms, setup 44ms, import 401ms, tests 94ms, environment 0ms)[22m

[34m % [39m[2mCoverage report from [22m[33mv8[39m
-------------------|---------|----------|---------|---------|-------------------
File               | % Stmts | % Branch | % Funcs | % Lines | Uncovered Line #s 
-------------------|---------|----------|---------|---------|-------------------
All files          |    4.04 |     2.48 |    3.66 |     4.1 |                   
 src               |   17.46 |        4 |    4.76 |    17.6 |                   
  db-init.ts       |     100 |       50 |     100 |     100 | 100               
  db.ts            |    87.5 |       50 |     100 |    87.5 | 14                
  instrument.ts    |       0 |        0 |       0 |       0 | 4-61              
  sentry.ts        |       0 |      100 |       0 |       0 | 9-18              
  socket.ts        |    1.33 |        0 |       0 |    1.33 | 14-219            
 src/middleware    |   18.84 |     8.62 |      25 |   18.84 |                   
  auth.ts          |   44.82 |    31.25 |   66.66 |   44.82 | ...34,41-56,63-88 
  csrf.ts          |       0 |        0 |       0 |       0 | 19-135            
  errorHandler.ts  |       0 |        0 |       0 |       0 | 16-35             
  metrics.ts       |       0 |        0 |       0 |       0 | 14-34             
 src/migrations    |   21.05 |    13.63 |    7.69 |   21.95 |                   
  index.ts         |   67.85 |       60 |      80 |   65.38 | 22,65-78          
  ...migrations.ts |    1.49 |        0 |       0 |    1.78 | 22-339            
 ...tions/versions |    9.09 |      100 |       0 |    9.09 |                   
  ...hancements.ts |   14.28 |      100 |       0 |   14.28 | 9-104             
  ...p-transfer.ts |    6.66 |      100 |       0 |    6.66 | 10-85             
 src/routes        |    6.97 |      5.6 |    9.15 |    7.12 |                   
  analytics.ts     |       0 |        0 |       0 |       0 | 9-81              
  audit.ts         |       0 |        0 |       0 |       0 | 12-105            
  auth.ts          |       0 |        0 |       0 |       0 | 21-428            
  backup.ts        |       0 |        0 |       0 |       0 | 13-281            
  bulk.ts          |       0 |        0 |       0 |       0 | 12-191            
  csrf.ts          |       0 |      100 |       0 |       0 | 4-49              
  custom-fields.ts |       0 |        0 |       0 |       0 | 19-158            
  debug.ts         |       0 |        0 |       0 |       0 | 4-14              
  departments.ts   |       0 |        0 |       0 |       0 | 18-156            
  ...ers-simple.ts |       0 |        0 |       0 |       0 | 7-111             
  ...org-owners.ts |       0 |        0 |       0 |       0 | 7-96              
  ...aintenance.ts |       0 |        0 |       0 |       0 | 12-174            
  geds-import.ts   |       0 |        0 |       0 |       0 | 22-339            
  geds.ts          |       0 |        0 |       0 |       0 | 6-61              
  import.ts        |       0 |        0 |       0 |       0 | 9-252             
  invitations.ts   |       0 |        0 |       0 |       0 | 13-118            
  members.ts       |       0 |        0 |       0 |       0 | 19-265            
  metrics.ts       |       0 |      100 |       0 |       0 | 17-86             
  ...ship-check.ts |       0 |        0 |       0 |       0 | 7-70              
  organizations.ts |   84.84 |    71.42 |     100 |   84.84 | ...28,254,292,317 
  ...-transfers.ts |       0 |        0 |       0 |       0 | 13-138            
  passkey.ts       |       0 |        0 |       0 |       0 | 20-237            
  people.ts        |       0 |        0 |       0 |       0 | 19-202            
  public.ts        |       0 |        0 |       0 |       0 | 8-238             
  ...d-searches.ts |   88.88 |      100 |     100 |   88.88 | 37,50,70          
  search.ts        |       0 |        0 |       0 |       0 | 6-113             
  totp.ts          |       0 |        0 |       0 |       0 | 12-189            
  users.ts         |       0 |        0 |       0 |       0 | 17-217            
  version.ts       |       0 |      100 |       0 |       0 | 3-14              
 src/services      |       0 |        0 |       0 |       0 |                   
  ...cs.service.ts |       0 |        0 |       0 |       0 | 10-134            
  audit.service.ts |       0 |        0 |       0 |       0 | 22-391            
  auth.service.ts  |       0 |        0 |       0 |       0 | 15-450            
  ...up.service.ts |       0 |        0 |       0 |       0 | 7-247             
  bulk.service.ts  |       0 |        0 |       0 |       0 | 128-817           
  csrf.service.ts  |       0 |        0 |       0 |       0 | 26-111            
  ...ds.service.ts |       0 |        0 |       0 |       0 | 13-401            
  ...nt.service.ts |       0 |        0 |       0 |       0 | 13-423            
  email.service.ts |       0 |        0 |       0 |       0 | 4-249             
  ...ce.service.ts |       0 |        0 |       0 |       0 | 43-318            
  ...er.service.ts |       0 |        0 |       0 |       0 | 29-141            
  ...ad.service.ts |       0 |        0 |       0 |       0 | 11-226            
  ...er.service.ts |       0 |        0 |       0 |       0 | 4-290             
  ...on.service.ts |       0 |        0 |       0 |       0 | 11-405            
  ...er.service.ts |       0 |        0 |       0 |       0 | 72-590            
  ...or.service.ts |       0 |        0 |       0 |       0 | 12-114            
  ...cs.service.ts |       0 |        0 |       0 |       0 | 28-358            
  ...up.service.ts |       0 |        0 |       0 |       0 | 6-43              
  org.service.ts   |       0 |        0 |       0 |       0 | 65-262            
  ...er.service.ts |       0 |        0 |       0 |       0 | 73-957            
  ...ey.service.ts |       0 |        0 |       0 |       0 | 20-228            
  ...le.service.ts |       0 |        0 |       0 |       0 | 17-411            
  ...ch.service.ts |       0 |        0 |       0 |       0 | 101-1063          
  ...ts.service.ts |       0 |        0 |       0 |       0 | 32-240            
  totp.service.ts  |       0 |        0 |       0 |       0 | 17-130            
  ...er.service.ts |       0 |        0 |       0 |       0 | 11-27             
  users.service.ts |       0 |        0 |       0 |       0 | 6-445             
 src/test-helpers  |       0 |        0 |       0 |       0 |                   
  ...-db-schema.ts |       0 |        0 |       0 |       0 | 11-378            
 src/types         |       0 |        0 |       0 |       0 |                   
  analytics.ts     |       0 |        0 |       0 |       0 |                   
  global.d.ts      |       0 |        0 |       0 |       0 |                   
  index.ts         |       0 |        0 |       0 |       0 | 221-228           
  metrics.ts       |       0 |        0 |       0 |       0 |                   
 src/utils         |   14.28 |        0 |       0 |   14.28 |                   
  escape.ts        |       0 |        0 |       0 |       0 | 1-17              
  logger.ts        |   22.22 |        0 |       0 |   22.22 | 23-30,36-42       
-------------------|---------|----------|---------|---------|-------------------
